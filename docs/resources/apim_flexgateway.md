---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "anypoint_apim_flexgateway Resource - terraform-provider-anypoint"
subcategory: ""
description: |-
  Create an API Manager Instance of type Flex Gateway.
      When an API instance of type Flex Gateway is created, it has automatically a default upstream linked to the endpoint_uri and a routing that points to this one.
      This provider will remove all default routings and upstreams.
---

# anypoint_apim_flexgateway (Resource)

Create an API Manager Instance of type Flex Gateway.
		When an API instance of type Flex Gateway is created, it has automatically a default upstream linked to the endpoint_uri and a routing that points to this one.
		This provider will remove all default routings and upstreams.

## Example Usage

```terraform
resource "anypoint_apim_flexgateway" "fg" {
  org_id = var.root_org
  env_id = "7074fcdd-9b23-4ab3-97c8-5db5f4adf17d"
  asset_group_id = var.root_org
  asset_id = "flex-backend-app-test"
  asset_version = "1.0.0"
  deployment_target_id = data.anypoint_flexgateway_target.target.id
  deployment_target_name = data.anypoint_flexgateway_target.target.name
  deployment_gateway_version = data.anypoint_flexgateway_target.target.version
  deployment_expected_status = "deployed"
  deployment_overwrite = true
  deployment_type = "HY"
  instance_label  = "my terraform flex instance"
  endpoint_proxy_uri = "http://consumer.url/hello/world/2"
  routing {
    label = "my-route01"
    upstreams {
      label = "upstream01"
      weight = 100
    }
    rules {
      methods = [ "POST", "GET" ]
      host = ".*"
      path = "/.*"
      headers = {
        "x-example-header" = ".*"
        "x-correlation-id" = ".*"
      }
    }
  }
  upstreams {
    label = "upstream01"
    uri = "http://192.168.1.166:3000"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `asset_group_id` (String) The API specification's business group id
- `asset_id` (String) The API specification's asset id in exchange
- `asset_version` (String) The API specification's version number in exchange
- `deployment_target_id` (String) The instance's deployment flex gateway target id
- `deployment_target_name` (String) The instance's deployment flex gateway target name
- `env_id` (String) The environment id where the flex gateway instance is defined.
- `org_id` (String) The organization id where the flex gateway instance is defined.
- `routing` (Block List, Min: 1) The instance's routing mapping (see [below for nested schema](#nestedblock--routing))
- `upstreams` (Block List, Min: 1) The list of upstreams to be created for this particular api instance (see [below for nested schema](#nestedblock--upstreams))

### Optional

- `deployment_expected_status` (String) The instance's deployment expected status. "deployed" or "undeployed"
- `deployment_gateway_version` (String) The instance's deployment gateway version
- `deployment_overwrite` (Boolean) The API Manager Instance id
- `deployment_type` (String) The instance's deployment update date
- `deprecated` (Boolean) True if the instance is deprecated
- `description` (String) The description of the instance
- `endpoint_deployment_type` (String) Endpoint's deployment type
- `endpoint_proxy_registration_uri` (String) Endpoint's Proxy registration URI
- `endpoint_proxy_uri` (String) Endpoint's Proxy URI
- `endpoint_tls_inbound_context` (Block Set, Max: 1) (see [below for nested schema](#nestedblock--endpoint_tls_inbound_context))
- `instance_label` (String) The Instance's label
- `last_updated` (String) The last time this resource has been updated locally.
- `provider_id` (String) The client identity provider's id to use for this instance
- `tags` (List of String) List of tags

### Read-Only

- `audit` (Map of String) The instance's auditing data
- `autodiscovery_instance_name` (String) The instance's discovery name
- `deployment_api_id` (Number) The API Manager Instance id
- `deployment_application_id` (String) The instance's deployment application id
- `deployment_application_name` (String) The instance's deployment application name
- `deployment_audit_created_date` (String) The instance's deployment auditing creation date
- `deployment_audit_updated_date` (String) The instance's deployment auditing update date
- `deployment_environment_id` (String) The instance's deployment environment id
- `deployment_environment_name` (String) The instance's deployment environment name
- `deployment_id` (Number) The instance's deployment id
- `deployment_updated_date` (String) The instance's deployment update date
- `endpoint_api_gateway_version` (String) Endpoint's api gateway version
- `endpoint_api_version_id` (Number) The API Manager Instance id
- `endpoint_audit` (Map of String) The instance's endpoint auditing data
- `endpoint_id` (Number) The instance's endpoint id
- `endpoint_last_active_date` (String) Endpoint's last active date
- `endpoint_type` (String) The endpoint's specification type
- `endpoint_uri` (String) The endpoint URI of this instance API
- `id` (String) The API Manager Flex Gateway instance id.
- `is_public` (Boolean) If this API is Public
- `last_active_date` (String) The date of last activity for this instance
- `master_organization_id` (String) The root business group id
- `order` (Number) The order of this instance in the API Manager instances list
- `product_version` (String) The instance's asset major version number
- `status` (String) The API Instance status
- `technology` (String) The type of API Manager instance. Always equals to 'flexGateway'

<a id="nestedblock--routing"></a>
### Nested Schema for `routing`

Required:

- `label` (String) The route label
- `upstreams` (Block Set, Min: 1) Upstreams for this particular route (see [below for nested schema](#nestedblock--routing--upstreams))

Optional:

- `rules` (Block Set, Max: 1) Define methods, hosts and other settings for this route (see [below for nested schema](#nestedblock--routing--rules))

<a id="nestedblock--routing--upstreams"></a>
### Nested Schema for `routing.upstreams`

Required:

- `label` (String) The exact label of the upstream from the list of declared upstreams.
- `weight` (Number) The weight of this particular upstream. All upstreams for a single route should add up to 100.

Read-Only:

- `id` (String) The id of the upstream


<a id="nestedblock--routing--rules"></a>
### Nested Schema for `routing.rules`

Optional:

- `headers` (Map of String) Map of header names and values (regular expressions) that must be present in the request
- `host` (String) A regular expression to match the request host
- `methods` (Set of String) List of request methods that should be matched for this route. Supported values are GET, PUT, DELETE, OPTIONS, POST, PATCH, HEAD, TRACE, CONNECT
- `path` (String) A regular expression to match the request path



<a id="nestedblock--upstreams"></a>
### Nested Schema for `upstreams`

Required:

- `label` (String) The upstream's label. Used to select the upstream inside a routing.
- `uri` (String) The upstram URI

Optional:

- `tls_context` (Block Set, Max: 1) (see [below for nested schema](#nestedblock--upstreams--tls_context))

Read-Only:

- `audit` (Map of String) The upstream's auditing data
- `id` (String) The upstream's id

<a id="nestedblock--upstreams--tls_context"></a>
### Nested Schema for `upstreams.tls_context`

Required:

- `secret_group_id` (String) The secret group id
- `tls_context_id` (String) The TLS context id in the given secret group

Read-Only:

- `audit` (Map of String) The auditing data for tls context
- `authorized` (Boolean) The TLS context authorization status
- `name` (String) The TLS context name



<a id="nestedblock--endpoint_tls_inbound_context"></a>
### Nested Schema for `endpoint_tls_inbound_context`

Required:

- `secret_group_id` (String) The secret group id
- `tls_context_id` (String) The TLS context id in the given secret group

Read-Only:

- `audit` (Map of String) The auditing data for tls context
- `authorized` (String) The TLS context authorization status
- `name` (String) The TLS context name

## Import

Import is supported using the following syntax:

```shell
# In order for the import to work, you should provide a ID composed of the following:
#  {ORG_ID}/{ENV_ID}/{API_ENV_ID}

terraform import \
  -var-file params.tfvars.json \    #variables file
  anypoint_apim_flexgateway.fg \                #resource name
  aa1f55d6-213d-4f60-845c-201282484cd1/7074fcdd-9b23-4ab6-97r8-5db5f4adf17d/19218070    #resource ID
```
